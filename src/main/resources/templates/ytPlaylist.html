<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
  <meta charset="UTF-8">
  <title>YouTube Audio Player</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 20px; }
    #player { display: none; } /* ẩn video */
    .controls { margin-top: 20px; }
    button { margin: 0 5px; padding: 5px 10px; }
    input[type=range] { width: 200px; }
  </style>
</head>
<body>
<h2>Phát nhạc từ YouTube</h2>

<div id="player"></div>

<div class="controls">
  <button onclick="play()">▶ Play</button>
  <button onclick="pause()">⏸ Pause</button>
  <input type="range" id="seek" min="0" max="100" value="0">
  <input type="range" id="volume" min="0" max="100" value="100">
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
  let player, duration;
  const embedUrl = /*[[${embedUrl}]]*/ '';

  function onYouTubeIframeAPIReady() {
    const videoId = embedUrl.split("/embed/")[1].split("?")[0];
    player = new YT.Player('player', {
      height: '0',
      width: '0',
      videoId: videoId,
      events: { 'onReady': onPlayerReady }
    });
  }

  function onPlayerReady() {
    duration = player.getDuration();
    setInterval(updateSeek, 1000);
  }

  function play() { player.playVideo(); }
  function pause() { player.pauseVideo(); }

  function updateSeek() {
    if (player && player.getCurrentTime) {
      const current = player.getCurrentTime();
      document.getElementById('seek').value = (current / duration) * 100;
    }
  }

  document.getElementById('seek').addEventListener('input', e => {
    if (duration) {
      const seekTo = (e.target.value / 100) * duration;
      player.seekTo(seekTo, true);
    }
  });

  document.getElementById('volume').addEventListener('input', e => {
    player.setVolume(e.target.value);
  });
</script>
</body>
</html>
